import os
import pandas as pd
import warnings
import logging
warnings.filterwarnings('ignore')

DAILY_LOAD_BEGINDATE = '20080101'
DAILY_LOAD_ENDDATE = '20201231'

LJS_PATH = '/data/analysis/ljs/'
ROOT_PATH = '/cache/aaron'
data_path = '/home/aaron/data/pkl/'
TERM_DES_PATH = '~/cache/'
PKL_CACHE_PATH = '/cache/aaron/data/pkl'
DATA = {}
TERM = {}
PATH = {}
VARS = {}
PFMS = {}


def gen_var_dict(path, subdir = 'byVar'):
    cat_list = os.listdir(path)
    var_dfs  = []
    for cat in cat_list:
        varnames = [str.split(f, sep='.')[0] for f in os.listdir(os.path.join(path, cat, subdir))]
        var_dfs.append(pd.DataFrame({'cat_name': cat, 'var_name': varnames}))
        
    var_dfs = pd.concat(var_dfs)
    var_dfs['full_name'] = var_dfs.var_name + '__' + var_dfs.cat_name
    return var_dfs

def gen_global_var(freq, base_path):
    
    #base_path = os.path.join(data_path, freq)
    data = {}
    data['ret'] = pd.read_pickle(os.path.join(base_path, freq, 'bar', 'Ret.pkl'))
    data['retm'] = pd.read_pickle(os.path.join(base_path, freq, 'bar', 'Ret.pkl'))
    data['alev'] = pd.read_pickle(os.path.join(base_path, freq, 'univ', 'alev.pkl'))
    data['citics1'] = pd.read_pickle(os.path.join(base_path, freq, 'group', 'citics1.pkl'))
    data['var_dict'] = gen_var_dict(os.path.join(base_path, freq), subdir='')
    data['T'] = list(data['ret'].index)
    data['K'] = list(data['ret'].columns)
    data['freq'] = freq
    
    return data

def data_init(path, beginDate, endDate):
    pass

def get_timestamps(freq):
    if freq == 'M10': return m10_timestamps
    elif freq == 'DAILY': return daily_timestamps
    elif freq == 'M1': return m1_timestamps
    elif freq == 'M5': return m5_timestamps



#DATA = gen_global_var('M10', data_path)

daily_timestamps = ['15:00:00.000']

m5_timestamps = ['09:35:00.000', '09:40:00.000', '09:45:00.000', '09:50:00.000',
       '09:55:00.000', '10:00:00.000', '10:05:00.000', '10:10:00.000',
       '10:15:00.000', '10:20:00.000', '10:25:00.000', '10:30:00.000',
       '10:35:00.000', '10:40:00.000', '10:45:00.000', '10:50:00.000',
       '10:55:00.000', '11:00:00.000', '11:05:00.000', '11:10:00.000',
       '11:15:00.000', '11:20:00.000', '11:25:00.000', '11:30:00.000',
       '13:05:00.000', '13:10:00.000', '13:15:00.000', '13:20:00.000',
       '13:25:00.000', '13:30:00.000', '13:35:00.000', '13:40:00.000',
       '13:45:00.000', '13:50:00.000', '13:55:00.000', '14:00:00.000',
       '14:05:00.000', '14:10:00.000', '14:15:00.000', '14:20:00.000',
       '14:25:00.000', '14:30:00.000', '14:35:00.000', '14:40:00.000',
       '14:45:00.000', '14:50:00.000', '14:55:00.000', '15:00:00.000']

m10_timestamps = ['09:40:00.000', '09:50:00.000', '10:00:00.000', '10:10:00.000',
       '10:20:00.000', '10:30:00.000', '10:40:00.000', '10:50:00.000',
       '11:00:00.000', '11:10:00.000', '11:20:00.000', '11:30:00.000',
       '13:10:00.000', '13:20:00.000', '13:30:00.000', '13:40:00.000',
       '13:50:00.000', '14:00:00.000', '14:10:00.000', '14:20:00.000',
       '14:30:00.000', '14:40:00.000', '14:50:00.000', '15:00:00.000']

m1_timestamps = ['09:31:00.000', '09:32:00.000', '09:33:00.000', '09:34:00.000',
       '09:35:00.000', '09:36:00.000', '09:37:00.000', '09:38:00.000',
       '09:39:00.000', '09:40:00.000', '09:41:00.000', '09:42:00.000',
       '09:43:00.000', '09:44:00.000', '09:45:00.000', '09:46:00.000',
       '09:47:00.000', '09:48:00.000', '09:49:00.000', '09:50:00.000',
       '09:51:00.000', '09:52:00.000', '09:53:00.000', '09:54:00.000',
       '09:55:00.000', '09:56:00.000', '09:57:00.000', '09:58:00.000',
       '09:59:00.000', '10:00:00.000', '10:01:00.000', '10:02:00.000',
       '10:03:00.000', '10:04:00.000', '10:05:00.000', '10:06:00.000',
       '10:07:00.000', '10:08:00.000', '10:09:00.000', '10:10:00.000',
       '10:11:00.000', '10:12:00.000', '10:13:00.000', '10:14:00.000',
       '10:15:00.000', '10:16:00.000', '10:17:00.000', '10:18:00.000',
       '10:19:00.000', '10:20:00.000', '10:21:00.000', '10:22:00.000',
       '10:23:00.000', '10:24:00.000', '10:25:00.000', '10:26:00.000',
       '10:27:00.000', '10:28:00.000', '10:29:00.000', '10:30:00.000',
       '10:31:00.000', '10:32:00.000', '10:33:00.000', '10:34:00.000',
       '10:35:00.000', '10:36:00.000', '10:37:00.000', '10:38:00.000',
       '10:39:00.000', '10:40:00.000', '10:41:00.000', '10:42:00.000',
       '10:43:00.000', '10:44:00.000', '10:45:00.000', '10:46:00.000',
       '10:47:00.000', '10:48:00.000', '10:49:00.000', '10:50:00.000',
       '10:51:00.000', '10:52:00.000', '10:53:00.000', '10:54:00.000',
       '10:55:00.000', '10:56:00.000', '10:57:00.000', '10:58:00.000',
       '10:59:00.000', '11:00:00.000', '11:01:00.000', '11:02:00.000',
       '11:03:00.000', '11:04:00.000', '11:05:00.000', '11:06:00.000',
       '11:07:00.000', '11:08:00.000', '11:09:00.000', '11:10:00.000',
       '11:11:00.000', '11:12:00.000', '11:13:00.000', '11:14:00.000',
       '11:15:00.000', '11:16:00.000', '11:17:00.000', '11:18:00.000',
       '11:19:00.000', '11:20:00.000', '11:21:00.000', '11:22:00.000',
       '11:23:00.000', '11:24:00.000', '11:25:00.000', '11:26:00.000',
       '11:27:00.000', '11:28:00.000', '11:29:00.000', '11:30:00.000',
       '13:01:00.000', '13:02:00.000', '13:03:00.000', '13:04:00.000',
       '13:05:00.000', '13:06:00.000', '13:07:00.000', '13:08:00.000',
       '13:09:00.000', '13:10:00.000', '13:11:00.000', '13:12:00.000',
       '13:13:00.000', '13:14:00.000', '13:15:00.000', '13:16:00.000',
       '13:17:00.000', '13:18:00.000', '13:19:00.000', '13:20:00.000',
       '13:21:00.000', '13:22:00.000', '13:23:00.000', '13:24:00.000',
       '13:25:00.000', '13:26:00.000', '13:27:00.000', '13:28:00.000',
       '13:29:00.000', '13:30:00.000', '13:31:00.000', '13:32:00.000',
       '13:33:00.000', '13:34:00.000', '13:35:00.000', '13:36:00.000',
       '13:37:00.000', '13:38:00.000', '13:39:00.000', '13:40:00.000',
       '13:41:00.000', '13:42:00.000', '13:43:00.000', '13:44:00.000',
       '13:45:00.000', '13:46:00.000', '13:47:00.000', '13:48:00.000',
       '13:49:00.000', '13:50:00.000', '13:51:00.000', '13:52:00.000',
       '13:53:00.000', '13:54:00.000', '13:55:00.000', '13:56:00.000',
       '13:57:00.000', '13:58:00.000', '13:59:00.000', '14:00:00.000',
       '14:01:00.000', '14:02:00.000', '14:03:00.000', '14:04:00.000',
       '14:05:00.000', '14:06:00.000', '14:07:00.000', '14:08:00.000',
       '14:09:00.000', '14:10:00.000', '14:11:00.000', '14:12:00.000',
       '14:13:00.000', '14:14:00.000', '14:15:00.000', '14:16:00.000',
       '14:17:00.000', '14:18:00.000', '14:19:00.000', '14:20:00.000',
       '14:21:00.000', '14:22:00.000', '14:23:00.000', '14:24:00.000',
       '14:25:00.000', '14:26:00.000', '14:27:00.000', '14:28:00.000',
       '14:29:00.000', '14:30:00.000', '14:31:00.000', '14:32:00.000',
       '14:33:00.000', '14:34:00.000', '14:35:00.000', '14:36:00.000',
       '14:37:00.000', '14:38:00.000', '14:39:00.000', '14:40:00.000',
       '14:41:00.000', '14:42:00.000', '14:43:00.000', '14:44:00.000',
       '14:45:00.000', '14:46:00.000', '14:47:00.000', '14:48:00.000',
       '14:49:00.000', '14:50:00.000', '14:51:00.000', '14:52:00.000',
       '14:53:00.000', '14:54:00.000', '14:55:00.000', '14:56:00.000',
       '14:57:00.000', '14:58:00.000', '14:59:00.000', '15:00:00.000']

m5_timestamps = ['09:35:00.000',
 '09:40:00.000',
 '09:45:00.000',
 '09:50:00.000',
 '09:55:00.000',
 '10:00:00.000',
 '10:05:00.000',
 '10:10:00.000',
 '10:15:00.000',
 '10:20:00.000',
 '10:25:00.000',
 '10:30:00.000',
 '10:35:00.000',
 '10:40:00.000',
 '10:45:00.000',
 '10:50:00.000',
 '10:55:00.000',
 '11:00:00.000',
 '11:05:00.000',
 '11:10:00.000',
 '11:15:00.000',
 '11:20:00.000',
 '11:25:00.000',
 '11:30:00.000',
 '13:05:00.000',
 '13:10:00.000',
 '13:15:00.000',
 '13:20:00.000',
 '13:25:00.000',
 '13:30:00.000',
 '13:35:00.000',
 '13:40:00.000',
 '13:45:00.000',
 '13:50:00.000',
 '13:55:00.000',
 '14:00:00.000',
 '14:05:00.000',
 '14:10:00.000',
 '14:15:00.000',
 '14:20:00.000',
 '14:25:00.000',
 '14:30:00.000',
 '14:35:00.000',
 '14:40:00.000',
 '14:45:00.000',
 '14:50:00.000',
 '14:55:00.000',
 '15:00:00.000']
